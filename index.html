<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sims-web</title>
</head>

<body>
    <h1>SIMS Web</h1>
</body>

<script type="module">
    import h5wasm from "https://cdn.jsdelivr.net/npm/h5wasm@0.7.8/dist/esm/hdf5_hl.js";

    // the WASM loads asychronously, and you can get the module like this:
    const Module = await h5wasm.ready;
    console.log("h5wasm loaded")

    // then you can get the FileSystem object from the Module:
    const { FS } = Module;

    // Or, you can directly get the FS if you don't care about the rest 
    // of the module:
    // const { FS } = await h5wasm.ready;

    // let response = await fetch("https://ncnr.nist.gov/pub/ncnrdata/vsans/202003/24845/data/sans59510.nxs.ngv");
    let response = await fetch("data/pbmc3k.h5ad");
    let ab = await response.arrayBuffer();

    FS.writeFile("temp.h5ad", new Uint8Array(ab));

    // use mode "r" for reading.  All modes can be found in h5wasm.ACCESS_MODES
    let f = new h5wasm.File("temp.h5ad", "r");
    console.log(f);

    console.log(f.keys());
</script>

</html>